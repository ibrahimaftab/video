const events={playerReady:"playerReady",playPause:"playPause",play:"play",pause:"pause",end:"end",forward:"forward",backward:"backward",toggleFullScreen:"toggleFullScreen",fullscreen:"fullscreen",exitFullscreen:"exitFullscreen",toggleMute:"toggleMute",mute:"mute",unmute:"unmute",live:"live",playable:"playable",loading:"loading",loaded:"loaded",beforePlay:"beforePlay",initiated:"initiated",volumechange:"volumechange",pictureInPicture:"pictureInPicture",exitPictureInPicture:"exitPictureInPicture",resizePictureInPicture:"resizePictureInPicture",toggleSubtitle:"toggleSubtitle",showSubtitle:"showSubtitle",hideSubtitle:"hideSubtitle",playerActive:"playerActive",playerUnActive:"playerUnActive",dynamicDashJs:"dynamicDashJs",dynamicHlsJs:"dynamicHlsJs"},keyTriggerEvent={" ":events.playPause,ArrowLeft:events.backward,ArrowRight:events.forward,m:events.toggleMute,f:events.toggleFullScreen,t:events.toggleSubtitle};class Player extends HTMLElement{static unactivePlayer;#settings;#unactivePlayer=null;video=document.createElement("video");playerbar=null;loader=null;overlayplay=document.createElement("overlayplay");beforePlay=null;pictureInPicture=null;constructor(){super(),this.#settings=this.parentElement.videoManiaConfig;var e=`<style id='videomania-style'>
      @layer base {
        ${this.#settings.selector} vm-player {
          width: ${this.#settings.width}px;
          height: ${this.#settings.height}px;
        }
      }
    </style>`;document.head.insertAdjacentHTML("beforeend",e),this.overlayplay.innerHTML='<svg class="play-icon" style="enable-background: new 0 0 512 512" version="1.1" viewBox="0 0 512 512" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" > <path d="M405.2,232.9L126.8,67.2c-3.4-2-6.9-3.2-10.9-3.2c-10.9,0-19.8,9-19.8,20H96v344h0.1c0,11,8.9,20,19.8,20  c4.1,0,7.5-1.4,11.2-3.4l278.1-165.5c6.6-5.5,10.8-13.8,10.8-23.1C416,246.7,411.8,238.5,405.2,232.9z" /> </svg> <svg class="pause-icon" viewBox="0 0 32 32" width="32" xmlns="http://www.w3.org/2000/svg" > <path d="M12,6H10A2,2,0,0,0,8,8V24a2,2,0,0,0,2,2h2a2,2,0,0,0,2-2V8a2,2,0,0,0-2-2Z" /> <path d="M22,6H20a2,2,0,0,0-2,2V24a2,2,0,0,0,2,2h2a2,2,0,0,0,2-2V8a2,2,0,0,0-2-2Z" /> <rect /> </svg>'}async togglePlayer(){const e=(await import("./utils.js"))["triggerEvent"];this.#unactivePlayer&&clearTimeout(this.#unactivePlayer),this.classList.add("active"),e(events.playerActive,this),this.#unactivePlayer=setTimeout(()=>{this.classList.remove("active"),e(events.playerUnActive,this)},5e3)}qaulitiesList(){return this.#settings.qualities}subtitleList(){return{list:this.#settings.subtitles,toggleSubtitle:this.#settings.toggleSubtitle}}toggleSubtitle(e){this.#settings.toggleSubtitle=e}async initiatePlayer(e){e.preventDefault(),this.video.autoplay=this.#settings.autoplay,this.video.muted=this.#settings.muted,this.video.width=this.#settings.width,this.video.height=this.#settings.height,this.video.loop=this.#settings.loop,this.append(this.video,this.overlayplay);var e=this.#settings.rounded?"rounded":"";this.classList.add(e),this.#settings.controls&&(e=await import("./components/playerbar/playerbar.js"),customElements.define("vm-playerbar",e.default),this.insertAdjacentHTML("beforeend","<vm-playerbar />"))}checkIfVideoContainsAudio(){return void 0!==this.video.webkitAudioDecodedByteCount?0<this.video.webkitAudioDecodedByteCount:void 0!==this.video.mozHasAudio&&this.video.mozHasAudio}changePictureInPicture(e){this.pictureInPicture={width:e.width,height:e.height}}async connectedCallback(){const{retrieveFormat:e,replayIconBtn:t}=await import("./utils.js");var i=e(this.#settings.url),s=(await import("./functions/dynamic.js"))["dynamicFormats"];const a=(await import("./utils.js"))["triggerEvent"],n=events,r=events.keyTriggerEvent,l=(this.tabIndex=1,this.addEventListener("mouseenter",this.togglePlayer),this.addEventListener("mousemove",this.togglePlayer),this.addEventListener(n.playerReady,this.initiatePlayer),this.addEventListener(n.beforePlay,e=>{e.preventDefault(),this.dataset.toggle="played",this.video.play(),this.overlayplay.classList.add("active"),setTimeout(()=>{this.overlayplay.classList.remove("active")},200)}),this.beforePlay=e=>this.addEventListener(n.beforePlay,e,!0),this.addEventListener(n.play,()=>{a(n.beforePlay,this)}),this.addEventListener(n.pause,e=>{e.preventDefault(),this.dataset.toggle="paused",this.video.pause(),this.overlayplay.classList.add("active"),setTimeout(()=>{this.overlayplay.classList.remove("active")},200)}),this.addEventListener(n.playPause,e=>{e.preventDefault();e=this.video.paused?n.play:n.pause;a(e,this)}),this.addEventListener(n.end,e=>{e.preventDefault(),this.dataset.toggle="paused",this.video.currentTime=0,this.video.pause(),t(this),a(n.loaded,this)}),this.addEventListener(n.forward,async e=>{e.preventDefault(),this.video.currentTime=this.video.currentTime+this.#settings.forward;e=(await import("./icons.js")).forwardIcon;const t=this.overlayplay.cloneNode();t.innerHTML=e,this.append(t),t.classList.add("active"),setTimeout(()=>{t.classList.remove("active"),setTimeout(()=>{t.remove()},200)},200)}),this.addEventListener(n.backward,async e=>{e.preventDefault(),this.video.currentTime=this.video.currentTime-this.#settings.backward;e=(await import("./icons.js")).rewindIcon;const t=this.overlayplay.cloneNode();t.innerHTML=e,this.append(t),t.classList.add("active"),setTimeout(()=>{t.classList.remove("active"),setTimeout(()=>{t.remove()},200)},200)}),this.addEventListener(n.fullscreen,e=>{e.preventDefault(),this.requestFullscreen()}),this.addEventListener(n.exitFullscreen,e=>{e.preventDefault(),document.exitFullscreen()}),this.addEventListener(n.toggleFullScreen,e=>{e.preventDefault();e=document.fullscreenElement?"exitFullscreen":"fullscreen";a(e,this)}),this.addEventListener(n.mute,e=>{e.preventDefault(),this.video.muted=!0}),this.addEventListener(n.unmute,e=>{e.preventDefault(),this.video.muted=!1}),this.addEventListener(n.toggleMute,e=>{e.preventDefault();e=this.video.muted?"unmute":"mute";a(e,this)}),this.addEventListener(n.loading,async function(){var e,t;this.loader&&this.querySelector("#videoManiaLoader")||(e=document.createElement("loader"),t=(this.loader=e,await import("./icons.js"))["loaderAnimatedIcon"],e.innerHTML=t,e.id="videoManiaLoader",this.append(this.loader))}),this.addEventListener(n.loaded,async function(){this.loader&&this.querySelector("#videoManiaLoader")&&(this.querySelector("#"+this.loader.id).remove(),this.loader=null)}),this);if(this.video.addEventListener("ended",function(){a(n.end,l)}),this.addEventListener("keydown",async e=>{e.preventDefault(),Object.keys(r).includes(e.key)&&a(r[e.key],this)}),this.overlayplay.addEventListener("click",function(){a(n.playPause,this.parentElement)}),this.video.addEventListener("volumechange",function(){a(n.volumechange,this.parentElement)}),s.includes(i)){s=(await import("./functions/dynamic.js")).default(this,this.#settings.url)[i];document.querySelector("script#videomania-"+i)?s.init(this):(o=(await import("./utils.js"))["addScript"],o(s.url,i).onload=s.init);const a=(await import("./utils.js"))["triggerEvent"];a("playerReady",this)}else{var o=await import("./functions/html5Video.js");o.supportedVideoFormat.includes(i)&&(o.default(this),a("playerReady",this),this.video.src=this.#settings.url)}document.pictureInPictureEnabled&&(this.video.addEventListener("enterpictureinpicture",function(){a(n.pictureInPicture,l)}),this.video.addEventListener("leavepictureinpicture",function(){a(n.exitPictureInPicture,l),l.pictureInPicture=!1})),this.addEventListener(n.initiated,function(){var e=this.#settings.autoplay&&this.#settings.muted?"played":"paused";this.dataset.toggle=e})}}function videoMania(e,t="beforeend"){var i;if(customElements.get("vm-player")||customElements.define("vm-player",Player),document.querySelector(e?.selector))return 1<e.url.split(".").length&&(document.querySelector(e?.selector).videoManiaConfig={width:800,height:450,autoplay:!1,muted:!1,loop:!1,url:null,id:null,qualities:[],subtitles:[],toggleSubtitle:!1,forward:10,backward:10,controls:!0,rounded:!0,...e}),(i=document.querySelector(e.selector)).insertAdjacentHTML(t,`<vm-player data-selector="${e.selector}" />`),i.querySelector("vm-player")}